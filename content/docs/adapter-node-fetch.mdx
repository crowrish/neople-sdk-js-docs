---
title: Node-fetch ì–´ëŒ‘í„°
description: Node-fetch HTTP í´ë¼ì´ì–¸íŠ¸ ì–´ëŒ‘í„° ì„¤ì • ë° ì‚¬ìš©ë²•
---

# Node-fetch ì–´ëŒ‘í„°

Node-fetchë¥¼ ì‚¬ìš©í•˜ëŠ” ì–´ëŒ‘í„°ì…ë‹ˆë‹¤. ë¸Œë¼ìš°ì €ì˜ Fetch APIì™€ í˜¸í™˜ë˜ëŠ” Node.jsìš© êµ¬í˜„ì²´ì…ë‹ˆë‹¤.

## ì„¤ì¹˜

ë¨¼ì € node-fetchë¥¼ ì„¤ì¹˜í•´ì•¼ í•©ë‹ˆë‹¤:

```bash
npm install node-fetch
# ë˜ëŠ”
yarn add node-fetch

# TypeScript ì‚¬ìš© ì‹œ
npm install @types/node-fetch
```

## ê¸°ë³¸ ì‚¬ìš©ë²•

```typescript
import { NeopleDFClient, NeopleCyphersClient } from 'neople-sdk-js';

const client = new NeopleDFClient(apiKey, {
  httpAdapter: 'node-fetch'
});
```

## ì‚¬ìš©ì ì§€ì • ì„¤ì •

```typescript
import fetch from 'node-fetch';
import { NeopleDFClient } from 'neople-sdk-js';

const client = new NeopleDFClient(apiKey, {
  httpAdapter: 'node-fetch',
  fetchInstance: fetch,
  fetchOptions: {
    timeout: 30000,
    headers: {
      'User-Agent': 'MyApp/1.0.0'
    }
  }
});
```

## HTTP Agent ì„¤ì •

### Keep-Alive ì—°ê²°

```typescript
import fetch from 'node-fetch';
import http from 'http';
import https from 'https';
import { NeopleDFClient } from 'neople-sdk-js';

const httpAgent = new http.Agent({
  keepAlive: true,
  maxSockets: 10
});

const httpsAgent = new https.Agent({
  keepAlive: true,
  maxSockets: 10
});

const client = new NeopleDFClient(apiKey, {
  httpAdapter: 'node-fetch',
  fetchOptions: {
    agent: (parsedURL) => {
      return parsedURL.protocol === 'http:' ? httpAgent : httpsAgent;
    }
  }
});
```

### í”„ë¡ì‹œ ì„¤ì •

```bash
npm install https-proxy-agent
```

```typescript
import fetch from 'node-fetch';
import { HttpsProxyAgent } from 'https-proxy-agent';
import { NeopleDFClient } from 'neople-sdk-js';

const proxyAgent = new HttpsProxyAgent('http://proxy.example.com:8080');

const client = new NeopleDFClient(apiKey, {
  httpAdapter: 'node-fetch',
  fetchOptions: {
    agent: proxyAgent
  }
});
```

## SSL/TLS ì„¤ì •

### ì¸ì¦ì„œ ê²€ì¦ ë¹„í™œì„±í™” (ê°œë°œìš©)

```typescript
import fetch from 'node-fetch';
import https from 'https';
import { NeopleDFClient } from 'neople-sdk-js';

const agent = new https.Agent({
  rejectUnauthorized: false // ê°œë°œ í™˜ê²½ì—ì„œë§Œ ì‚¬ìš©
});

const client = new NeopleDFClient(apiKey, {
  httpAdapter: 'node-fetch',
  fetchOptions: {
    agent
  }
});
```

### ì‚¬ìš©ì ì§€ì • CA ì¸ì¦ì„œ

```typescript
import fetch from 'node-fetch';
import https from 'https';
import fs from 'fs';
import { NeopleDFClient } from 'neople-sdk-js';

const customCA = fs.readFileSync('path/to/ca-cert.pem');

const agent = new https.Agent({
  ca: customCA
});

const client = new NeopleDFClient(apiKey, {
  httpAdapter: 'node-fetch',
  fetchOptions: {
    agent
  }
});
```

## ìš”ì²­ ì••ì¶•

### Gzip ì••ì¶•

```typescript
import fetch from 'node-fetch';
import { NeopleDFClient } from 'neople-sdk-js';

const client = new NeopleDFClient(apiKey, {
  httpAdapter: 'node-fetch',
  fetchOptions: {
    compress: true,
    headers: {
      'Accept-Encoding': 'gzip, deflate'
    }
  }
});
```

## íƒ€ì„ì•„ì›ƒ ì„¤ì •

### AbortController ì‚¬ìš©

```typescript
import fetch from 'node-fetch';
import { NeopleDFClient } from 'neople-sdk-js';

const client = new NeopleDFClient(apiKey, {
  httpAdapter: 'node-fetch'
});

// ìš”ì²­ë³„ íƒ€ì„ì•„ì›ƒ
async function searchWithTimeout(name: string, timeoutMs: number = 10000) {
  const controller = new AbortController();
  const timeoutId = setTimeout(() => controller.abort(), timeoutMs);
  
  try {
    const result = await client.searchCharacter(name, {
      signal: controller.signal
    });
    clearTimeout(timeoutId);
    return result;
  } catch (error) {
    clearTimeout(timeoutId);
    if (error.name === 'AbortError') {
      throw new Error('ìš”ì²­ íƒ€ì„ì•„ì›ƒ');
    }
    throw error;
  }
}
```

### ì „ì—­ íƒ€ì„ì•„ì›ƒ

```typescript
import fetch from 'node-fetch';
import { NeopleDFClient } from 'neople-sdk-js';

const client = new NeopleDFClient(apiKey, {
  httpAdapter: 'node-fetch',
  fetchOptions: {
    timeout: 30000 // 30ì´ˆ
  }
});
```

## ìŠ¤íŠ¸ë¦¬ë°

### ì‘ë‹µ ìŠ¤íŠ¸ë¦¬ë°

```typescript
import fetch from 'node-fetch';
import { NeopleDFClient } from 'neople-sdk-js';
import { createWriteStream } from 'fs';
import { pipeline } from 'stream';

async function downloadStream(url: string, filePath: string) {
  const response = await fetch(url);
  
  if (!response.ok) {
    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
  }
  
  const writeStream = createWriteStream(filePath);
  
  return new Promise((resolve, reject) => {
    pipeline(response.body, writeStream, (error) => {
      if (error) {
        reject(error);
      } else {
        resolve(void 0);
      }
    });
  });
}
```

## ì¿ í‚¤ ì§€ì›

```bash
npm install tough-cookie
```

```typescript
import fetch from 'node-fetch';
import { CookieJar } from 'tough-cookie';
import { NeopleDFClient } from 'neople-sdk-js';

const cookieJar = new CookieJar();

const client = new NeopleDFClient(apiKey, {
  httpAdapter: 'node-fetch',
  fetchOptions: {
    headers: {
      'Cookie': await cookieJar.getCookieString('https://api.neople.co.kr')
    }
  }
});
```

## ì—ëŸ¬ ì²˜ë¦¬

### ìƒì„¸í•œ ì—ëŸ¬ ì •ë³´

```typescript
import fetch from 'node-fetch';
import { NeopleDFClient } from 'neople-sdk-js';

const client = new NeopleDFClient(apiKey, {
  httpAdapter: 'node-fetch',
  onError: (error) => {
    if (error.name === 'FetchError') {
      console.error('Fetch ì—ëŸ¬:', {
        message: error.message,
        type: error.type,
        errno: error.errno,
        code: error.code
      });
    } else if (error.name === 'AbortError') {
      console.error('ìš”ì²­ì´ ì¤‘ë‹¨ë¨');
    } else {
      console.error('ì•Œ ìˆ˜ ì—†ëŠ” ì—ëŸ¬:', error);
    }
  }
});
```

### HTTP ìƒíƒœ ì—ëŸ¬

```typescript
import fetch from 'node-fetch';
import { NeopleDFClient } from 'neople-sdk-js';

class HTTPError extends Error {
  constructor(public status: number, public statusText: string, public response: Response) {
    super(`HTTP ${status}: ${statusText}`);
    this.name = 'HTTPError';
  }
}

const customFetch = async (url: string, options: any) => {
  const response = await fetch(url, options);
  
  if (!response.ok) {
    throw new HTTPError(response.status, response.statusText, response);
  }
  
  return response;
};

const client = new NeopleDFClient(apiKey, {
  httpAdapter: 'node-fetch',
  fetchInstance: customFetch
});
```

## ì¬ì‹œë„ ë¡œì§

### ì§€ìˆ˜ ë°±ì˜¤í”„

```typescript
import fetch from 'node-fetch';
import { NeopleDFClient } from 'neople-sdk-js';

async function fetchWithRetry(
  url: string, 
  options: any, 
  maxRetries: number = 3
): Promise<any> {
  for (let attempt = 1; attempt <= maxRetries; attempt++) {
    try {
      const response = await fetch(url, options);
      
      if (response.ok) {
        return response;
      }
      
      // ì¬ì‹œë„ ê°€ëŠ¥í•œ ìƒíƒœ ì½”ë“œ í™•ì¸
      if (response.status >= 500 || response.status === 429) {
        if (attempt === maxRetries) {
          throw new Error(`HTTP ${response.status} after ${maxRetries} attempts`);
        }
        
        // ì§€ìˆ˜ ë°±ì˜¤í”„ ëŒ€ê¸°
        const delay = Math.min(1000 * Math.pow(2, attempt - 1), 30000);
        await new Promise(resolve => setTimeout(resolve, delay));
        continue;
      }
      
      throw new Error(`HTTP ${response.status}: ${response.statusText}`);
    } catch (error) {
      if (attempt === maxRetries) {
        throw error;
      }
      
      // ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ì— ëŒ€í•œ ì¬ì‹œë„
      const delay = Math.min(1000 * Math.pow(2, attempt - 1), 30000);
      await new Promise(resolve => setTimeout(resolve, delay));
    }
  }
}

const client = new NeopleDFClient(apiKey, {
  httpAdapter: 'node-fetch',
  fetchInstance: fetchWithRetry
});
```

## ë¡œê¹… ë° ë””ë²„ê¹…

### ìš”ì²­/ì‘ë‹µ ë¡œê¹…

```typescript
import fetch from 'node-fetch';
import { NeopleDFClient } from 'neople-sdk-js';

const debugFetch = async (url: string, options: any) => {
  console.log('ğŸš€ ìš”ì²­:', {
    url,
    method: options?.method || 'GET',
    headers: options?.headers
  });
  
  const startTime = Date.now();
  
  try {
    const response = await fetch(url, options);
    const duration = Date.now() - startTime;
    
    console.log('âœ… ì‘ë‹µ:', {
      status: response.status,
      statusText: response.statusText,
      duration: `${duration}ms`,
      headers: Object.fromEntries(response.headers.entries())
    });
    
    return response;
  } catch (error) {
    const duration = Date.now() - startTime;
    
    console.error('âŒ ì—ëŸ¬:', {
      error: error.message,
      duration: `${duration}ms`
    });
    
    throw error;
  }
};

const client = new NeopleDFClient(apiKey, {
  httpAdapter: 'node-fetch',
  fetchInstance: debugFetch
});
```

## ì„±ëŠ¥ ìµœì í™”

### Connection Pooling

```typescript
import fetch from 'node-fetch';
import http from 'http';
import https from 'https';
import { NeopleDFClient } from 'neople-sdk-js';

// ê¸€ë¡œë²Œ ì—ì´ì „íŠ¸ ì„¤ì •
const httpAgent = new http.Agent({
  keepAlive: true,
  maxSockets: 20,
  maxFreeSockets: 10,
  timeout: 60000,
  freeSocketTimeout: 30000
});

const httpsAgent = new https.Agent({
  keepAlive: true,
  maxSockets: 20,
  maxFreeSockets: 10,
  timeout: 60000,
  freeSocketTimeout: 30000
});

const client = new NeopleDFClient(apiKey, {
  httpAdapter: 'node-fetch',
  fetchOptions: {
    agent: (parsedURL) => {
      return parsedURL.protocol === 'http:' ? httpAgent : httpsAgent;
    }
  }
});
```

### ìš”ì²­ ë³‘ë ¬ ì²˜ë¦¬

```typescript
import fetch from 'node-fetch';
import pLimit from 'p-limit';
import { NeopleDFClient } from 'neople-sdk-js';

const limit = pLimit(10); // ìµœëŒ€ 10ê°œ ë™ì‹œ ìš”ì²­

async function fetchMultipleCharacters(names: string[]) {
  const client = new NeopleDFClient(apiKey, {
    httpAdapter: 'node-fetch'
  });

  const promises = names.map(name => 
    limit(() => client.searchCharacter(name))
  );

  try {
    return await Promise.all(promises);
  } catch (error) {
    console.error('ë³‘ë ¬ ìš”ì²­ ì¤‘ ì˜¤ë¥˜:', error);
    throw error;
  }
}
```

## TypeScript ì§€ì›

### íƒ€ì… ì•ˆì „í•œ ë˜í¼

```typescript
import fetch, { Response } from 'node-fetch';
import { NeopleDFClient } from 'neople-sdk-js';

interface TypedResponse<T> extends Response {
  json(): Promise<T>;
}

async function typedFetch<T>(
  url: string,
  options?: any
): Promise<TypedResponse<T>> {
  const response = await fetch(url, options);
  return response as TypedResponse<T>;
}

const client = new NeopleDFClient(apiKey, {
  httpAdapter: 'node-fetch',
  fetchInstance: typedFetch
});
```

## ë§ˆì´ê·¸ë ˆì´ì…˜

### ë‚´ì¥ Fetchì—ì„œ Node-fetchë¡œ

```typescript
// Before (ë‚´ì¥ Fetch - Node.js 18+)
const client = new NeopleDFClient(apiKey, {
  httpAdapter: 'fetch'
});

// After (Node-fetch - í•˜ìœ„ í˜¸í™˜)
const client = new NeopleDFClient(apiKey, {
  httpAdapter: 'node-fetch'
});
```

### Axiosì—ì„œ Node-fetchë¡œ

```typescript
// Before (Axios)
const client = new NeopleDFClient(apiKey, {
  httpAdapter: 'axios',
  axiosInstance: axios.create({
    timeout: 30000,
    headers: {
      'User-Agent': 'MyApp/1.0.0'
    }
  })
});

// After (Node-fetch)
const client = new NeopleDFClient(apiKey, {
  httpAdapter: 'node-fetch',
  fetchOptions: {
    timeout: 30000,
    headers: {
      'User-Agent': 'MyApp/1.0.0'
    }
  }
});
```